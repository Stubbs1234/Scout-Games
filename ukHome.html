<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">

  <title>Scout Games UK</title>
  <meta name="description" content="My Parse App">
  <meta name="viewport" content="width=device-width">
  <link rel="stylesheet" href="css/reset.css">
  <link rel="stylesheet" href="css/styles.css">
  <link rel="stylesheet" href="css/box.css">
  <link rel="stylesheet" href="css/print.css">
  <style type="text/css" media="screen"></style>
    <!--<script type="text/javascript" src="js/tablet.js"></script>-->
  <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
   <script src="//www.parsecdn.com/js/parse-1.6.14.min.js"></script>
</head>

<body>
<div id="main">
<div id="nav">
<div id="nav_wrapper">
<ul>
<li><a href="homeCheck.html">Your Home</a></li>
<li><a href="search.html">Search For A Game</a></li>
<li><a href="upload.html">Upload A Game</a></li>
<li><a href="store.html">Subscription</a></li>
<li><a href="#">More</a>
<ul>
<li><a href="contactus.html">Contact Us</a></li>
<li><a href="myGames.html">My Games</a></li>
<li><a href="edit.html">Edit Profile</a></li>
  </ul>
  <li><a href="logout.html">Log Out</a></li>
</div>
</div><br>
<script type="text/javascript">
Parse.initialize("oTP5FJ4M9ESGzja1SrNcgDn7N07xtUmXqjyL4Da9", "8x1n5FZy4tEcXToWhjZYRkGukF1T28Lv0rL7BZKe", "JD1RtWwNcyc5q312ABc9saQ1ofvJNtxMycUlrOcA");
Parse.serverURL = 'https://parseapi.back4app.com'
var user = Parse.User.current().get("FirstName")
var message = "Hi " + user + " Here is your dashboard";
document.addEventListener("DOMContentLoaded", function(event) {
document.getElementById("load").innerHTML = message;
});
</script>
<h1 align="center">Welcome to Scout Games</h1>
<h3 id="load" align="center"></h3>
<div id=news>
<h3>Recent News for the UK</h3>
<!--<p>22/09/2015 - Scout Game is now supports iOS9 <a href="newsPage.html#ios9"><img src="images/arrow-31-512.png" height="12" width="12"></a></p>-->
<p>09/09/2015 - Scout Game will be available on Mac OS X, Apple Tv <a href="newsPage.html#new"><img src="images/arrow-31-512.png" height="12" width="12"></a></p>
<p>11/08/2015 - Scout Games is now available for Canada, Australia, United States <a href="newsPage.html#world"><img src="images/arrow-31-512.png" height="12" width="12"></a></p>
<p>11/08/2015 - Scout Games for iOS is here <a href="newsPage.html#ios"><img src="images/arrow-31-512.png" height="12" width="12"></a></p>
</div>

 <h3 align="center">Your Favouritwe Games</h3> 
    <table id="first-team-results-table" class="table1" border="1xp" style="width:100%">
        <col width="5">
        <col width="80">
        <col width="80">
        <col width="300">
        <col width="100">
        <tbody>
            <tr>
                <th><input type="checkbox" class="chkSelectAll" /></th>
                <th>Name Of Game</th>
                <th>Item</th>
                <th>Description</th>
                <th>Group</th>
            </tr>
        </tbody>
    </table>
    <script type="text/javascript">
	 Parse.initialize("oTP5FJ4M9ESGzja1SrNcgDn7N07xtUmXqjyL4Da9", "8x1n5FZy4tEcXToWhjZYRkGukF1T28Lv0rL7BZKe", "JD1RtWwNcyc5q312ABc9saQ1ofvJNtxMycUlrOcA");
Parse.serverURL = 'https://parseapi.back4app.com'
	
var id = Parse.User.current().id;
var firstTeamResults = Parse.Object.extend("ukgames");
var query = new Parse.Query(firstTeamResults);
query.equalTo("favs", id);
//"group" , group
query.descending("updateAt");
query.find({success: function(results){  
if (results == "") { (function($) {
                $("#first-team-results-table").append("<tr><td class='ui-helper-center' colspan='5'>" 
                	+ "No Data Found Please Add Games To Your Favourite In Search Page" 
                    +"</td></tr>");
            })(jQuery);
       }else {     
        for (var i = 0; i < results.length; i++) 
        {
            var object = results[i];
               
            (function($) {
                $("#first-team-results-table").append("<tr><td>" 
                	+ "<input type='checkbox' class='chkNumber' value='"+object.id+"'/>"
                	+ "</td><td>"
                    + object.get("NameGame") 
                    + "</td><td>" 
                    + object.get("item") 
                    + "</td><td>"
                    + object.get("des") 
                    + "</td><td>" 
                    + object.get("group") 
                    +"</td></tr>");
            })(jQuery);
       }
    }
    },
    error: function(error) {
        alert("Error: " + error.code + " " + error.message);
    }
});
</script>
<br><div id="buttonShow"> 
    <input type="button" class="btnGetAll" value="More"/>
    </div>
    <div id="openModal" class="modalDialog">
	<div>
		<a href="#close" title="Close" class="close">X</a>
		<p>Please select an option</p>
		<input type="radio" name="share" value="DFYF">Delete From Your Favourites<br>
		<input type="radio" name="share" value="SVE">Share Via Email<br>
		<input type="radio" name="share" value="SVF">Share Via Facebook<br>
		<input type="radio" name="share" value="SVT">Share Via Twitter<br>
		<input type="radio" name="share" value="WV">Watch Video<br>
		<input type="radio" name="share" value="Print">Print<br>
		<input type="submit" id="go" value="Go"/>
	</div>
    <script type="text/javascript">    
var OBJECT = ""
var userEmail = ""
var userId = ""
var nameOfGame = ""
var des = ""
var needed = ""
var name = ""
var email = ""
var videoURL = ""
var webURLPRint = ""
      $('.btnGetAll').click(function () {
        if ($('.chkNumber:checked').length) {
          var chkId = '';
          $('.chkNumber:checked').each(function () {
            chkId += $(this).val() + ",";
          });
          chkId = chkId.slice(0, -1);
          OBJECT = chkId
          window.location="#openModal";
          //alert(OBJECT);
        }
        else {
          alert('Nothing Selected');
        }
      });

      $('.chkSelectAll').click(function () {
        $('.chkNumber').prop('checked', $(this).is(':checked'));
      });

      $('.chkNumber').click(function () {
        if ($('.chkNumber:checked').length == $('.chkNumber').length) {
          $('.chkSelectAll').prop('checked', true);
        }
        else {
          $('.chkSelectAll').prop('checked', false);
        }
      });
      $('#go').click(function () { 
      var selectedVal = "";
var selected = $("input[type='radio'][name='share']:checked");
if (selected.length > 0) {
    selectedVal = selected.val();
}
if (selectedVal == "WV") {
video();
} if (selectedVal == "DFYF") {
deleteFavs();
} if (selectedVal == "Print") {
var xcon = "ukgames";
webURLPRint = "http://scoutgames.co.uk/sharegames/scoutgames-sharegame.html?id="+OBJECT+"&con="+xcon;
var GameScore = Parse.Object.extend("ukgames");;
var query = new Parse.Query(GameScore);
query.equalTo("objectId", OBJECT);
query.first({
success: function(object) {
var name = object.get("NameGame");
var item = object.get("item");
var des = object.get("des");
//alert(name);
//alert(item);
//alert(des);

    document.getElementById("name").innerHTML = name;
    document.getElementById("item").innerHTML = item;
    document.getElementById("des").innerHTML = des;
    document.getElementById("web").innerHTML = webURLPRint;
print();
  },
  error: function(error) {
    alert("Error: " + error.code + " " + error.message);
  }
});
} if (selectedVal == "SVE") {
window.location="#close";
openEmail();
} if (selectedVal == "SVF") {
facebook();
} if (selectedVal == "SVT") {
twitter();
}
      });
function print() {
window.location="#close";
var DocumentContainer = document.getElementById("example-print");
    var WindowObject = window.open('', 'PrintWindow', 'width=750,height=650,top=50,left=50,toolbars=no,scrollbars=yes,status=no,resizable=yes');
      var str = "<style type='text/css' href='css/print.css'>";
            str = str + "</style>";
            WindowObject.document.writeln(str);
   WindowObject.document.writeln(DocumentContainer.innerHTML);
  
  
    WindowObject.document.close();
    WindowObject.focus();
    WindowObject.print();
    WindowObject.close();
}

function video() {
var GameScore = Parse.Object.extend("ukgames");;
var query = new Parse.Query(GameScore);
query.equalTo("objectId", OBJECT);
query.first({
success: function(object) {
var video = object.get("Video");
if (video == "undefined" || video == "") {
alert("Sorry no video found");
alert(video);
} else {
videoURL = video.url();
playVideo();
}
  },
  error: function(error) {
    alert("Error: " + error.code + " " + error.message);
  }
});
}
function playVideo() {
if (videoURL == "undefined" || videoURL == "") {
alert("Sorry no video found");
} else {
window.location="#close";
        var url  = videoURL
        var win = window.open(url, '_blank');
if(win){
    win.focus();
}else{
    alert('Please allow popups for this site');
}
}
}

function deleteFavs() {
Parse.initialize("oTP5FJ4M9ESGzja1SrNcgDn7N07xtUmXqjyL4Da9", "8x1n5FZy4tEcXToWhjZYRkGukF1T28Lv0rL7BZKe", "JD1RtWwNcyc5q312ABc9saQ1ofvJNtxMycUlrOcA");
Parse.serverURL = 'https://parseapi.back4app.com'
var id = Parse.User.current().id;
var GameScore = Parse.Object.extend("ukgames");;
var query = new Parse.Query(GameScore);
query.equalTo("objectId", OBJECT);
query.first({
  success: function(object) {
object.remove("favs", id);
object.save();
window.location="#close";
//alert("Done!");
location.reload();
  },
  error: function(error) {
    alert("Error: " + error.code + " " + error.message);
  }
});
}

function openEmail() {
window.location="#close";
name = prompt("Please enter the name of the person you would like to send the email to");
email = prompt("Please enter the email address of the person you would like to send the email to");
Parse.initialize("oTP5FJ4M9ESGzja1SrNcgDn7N07xtUmXqjyL4Da9", "8x1n5FZy4tEcXToWhjZYRkGukF1T28Lv0rL7BZKe", "JD1RtWwNcyc5q312ABc9saQ1ofvJNtxMycUlrOcA");
Parse.serverURL = 'https://parseapi.back4app.com'
userId = Parse.User.current().id;
userEmail = Parse.User.current().get("email");
var GameScore = Parse.Object.extend("ukgames");
var query = new Parse.Query(GameScore);
query.get(OBJECT, {
  success: function(gameScore) {
nameOfGame = gameScore.get("NameGame");
des = gameScore.get("des");
needed = gameScore.get("item");
sendEmail();
  },
  error: function(object, error) {
    // The object was not retrieved successfully.
    // error is a Parse.Error with an error code and message.
  }
});
}

function sendEmail() {
var xcon = "ukgames";
var url = "http://scoutgames.co.uk/sharegames/scoutgames-sharegame.html?id="+OBJECT+"&con="+xcon;
$.ajax({
      type: 'POST',
      url: 'https://mandrillapp.com/api/1.0/messages/send.json',
      data: {
        'key': 'tIaqXdWqVHTJoon3erigGg',
        'message': {
          'from_email': userEmail,
          'to': [
              {
                'email': email,
                'name': name,
                'type': 'to'
              }
            ],
          'autotext': 'true',
          'subject': 'Take a look at this game I have found using Scout Games',
          'html': 'Hey!\n\nCheck out This Game i have found using Scout Games Name Of the Game:' + nameOfGame +'\n\nEquipment Needed: '+ needed +'\n\nDescription: '+ des +'\n\nWhy dont you download and take a look for your self, and watch the video clip\n\n Check it out here '+ url +'\n\n'
        }
      }
     }).done(function(response) {
       alert("Sent!")
     });
} 

function facebook() {
var xcon = "ukgames";
var url = "http://scoutgames.co.uk/sharegames/scoutgames-sharegame.html?id="+OBJECT+"&con="+xcon;
var urlFacebook ="https://www.facebook.com/sharer/sharer.php?u="+url;
window.open(urlFacebook, '_blank');
}    

function twitter() {
var xcon = "ukgames";
var url = "http://scoutgames.co.uk/sharegames/sharegames/scoutgames-sharegame.html?id="+OBJECT+"&con="+xcon;
var urlTwitter ="https://twitter.com/intent/tweet?text=Hey%20Guys%20Check%20out%20what%20if%20have%20found%20on%20Scout%20Games&url="+url;
window.open(urlTwitter, '_blank');
}
</script> 
<div id="example-print">
<p id="name" class="name">Sorry No Data Found</p>
<p id="item" class="item">Sorry No Data Found</p>
<p id="des" class="des">Sorry No Data Found</p>
<p id="web" class="web">Sorry No Data Found</p>
</div> 
</div>
</div>
<div class="footer">
<small><p>Copyright &copy; Scout Games <span id="year"></span>, All rights reserved</p></small>
<small<p><a href="index.html">Login</a> | <a href="start/learn.html">Learn More</a> | <a href="store.html">Subscription</a></p></small>
<small><p>Powered By <a href="https://parse.com">Parse.com</a></p></small>
<script type="text/javascript">
var d = new Date();
var n = d.getFullYear();
document.getElementById("year").innerText = n;
</script>
</div>
</body>
</html>